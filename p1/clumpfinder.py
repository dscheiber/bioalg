def computingfrequencies2b(string, k, t, kmerMaster, freq):
    kmerList = kmerMaster
    frequencies = freq
    kmerListFinal = []
    for i in range(len(string)-k+1):
        kmer=string[i:i+k]
        index = kmerList.index(list(kmer))
        frequencies[index]+=1
    for i in range(len(frequencies)):
        if frequencies[i] == t:
            kmerListFinal.append("".join(kmerMaster[i]))
    return kmerListFinal

def clumpfinderb(genome, k, length, t):
    kmerFinal = []
    
    kmerMaster = list(xselections(["A","T", "G", "C"], k))
    kmerMaster.sort()

    frequencies = [0 for x in kmerMaster]

    for i in range(len(genome)-length+1):
        workingWindow = genome[i:i+length]
        kmerGet = computingfrequencies2b(workingWindow, k, t, kmerMaster, frequencies)
        if kmerGet != []:
            kmerFinal.append(" ".join(kmerGet))
        frequencies = [0 for x in kmerMaster]
        
    return " ".join(list(set(kmerFinal)))

def xselections(items, n):
    if n==0: yield []
    else:
        for i in xrange(len(items)):
            for ss in xselections(items, n-1):
                yield [items[i]]+ss

gen="TTCCAGAGTGCCAGACCGGCCACCCCTTACGAAGCCGGAGACCTATGTTCCACGGTCAGCCCGTTGTTGCCAACGATCGAGCCACTGAAATTCAATCCCCCCCACAGCAGTCGGTTTCGATCCTTTTTCTTGATAGTTTATGCTGCGCAAAGGGGGCGTCTCAGCTTCTGTAGTTACATAATCAATACCTCAATTGCACTCGACATACTATTCTCGTTGCAGAGCTAGTATCGTTGCGGAGTATCACAACAGAGTCAGTGGGTCACCTGCGTGTATCGGCAACGGTCGCGGGAAGAATTCCCCAATGGCTCATTGTTAAGTTTGGCTGGTTTCTTTTACCAACCTACTCTGAGGATAGCTGCAGTATTAGAACAAGCACGAAACCCCCCAGGAACGCACGTATTGACTTCTCCTTCTCCTAGATATCTCCTAGATTGTGAGACTATCTCCTAGATAGGGGGCGTTTGCATCCCTACACTAGCAGATGTCACTCTTGTATTTTTTTTAGGCTAGTCTTGTATTTCTCCTAGATCTTGTATTCCTAGACAGAATATTCGCCCATCTTGTATTCTTGTATTTTCTTGTATCTTGTATTCTTGTCTTGTATCTTGTATTCTCCTATCTCCTCTCCTAGTCTTGTATTTATTTTCTTGTATTATCTTGTATTGCTTCTTGTATTCTAGAAATGCGGCGCGGCAATTCTTCTTGTATTTCTTGTATTTAGCTATCTATTATTCAGTATTGAATCTCCTTCTCTCTTGTATTAGAGGCGGCAATTCATCTCCTATCTCCTCTTGTATTCGCGTCTTGTATTTTTAGAAGCGGCAATTAGTTGATCACCAATAAAACAAAGCGGCTCTCCTAGACTCTTTCTTGTATTGCAAGTACTTGAGTGCGGCGGCAATTGCAATTGGCGAAATCTTTCTTGTATTTTTCCACGAGTGTCCATTCGTTTAGGTTCAGTCGCGGTCTTGTATTTTTGGCGGTAGACTTCTCTTGTATTTATTTGAGCTCTTGTATTCATCTTGTATTGTCTTGTATTTGCGGCAATTAATTCGACAACCCCGTTGGGCGGCGGCAATTAATTATTAGCGGCGCGGCAATTAGTACTCAGGCGCCGCATATCCAACCACATGGCTCTCGCCGGTTTAATACGCGGCAATTCGGGCGGCAATTGGTTCGCGCTTTCGCTAATTATTTTAATATAATACGCCGCGGCAGCGGCAATTGCCCAATAAGGACCCGAATCCAGCAGAGCGGTGACCTCCGCGTACCACCCTTTTGCATCTATCTGCCTTCCAAAACCTGATATGCCTATTTGACCATTCCTCTCTCCCCTTGGGACTTTTCTTTTCCAAAACGACATATAGATACTGCGCTCGCCGAACATGTTTCCAAAACAAACTTTGTTTTTTTTCCAAAACCTCACCGCCGGCGGTTCCAAAACAACAACTCCCTGGCCCATTCCCATACTTGAGACCCTGGGATCAATTCCAAAACGGTTCCAAAACTCAATTGAGCAGTCTGCCCGAGTTCCAAAACTGTTCCAAAACACCCGTGGTTGTCTTGGCTGTTCCAAAACAGAGACGCCTTGTCGCTTTTTTCCAAAACCTGCTTAACCGCATCCAGCTAAGTAAGTCTGGTTAGGTCTGCCTATCGATTGCTGACACTGAGTTCCAAAACTTCCTTCCAAAACATCCATTATTTTCCAAAACAAAACGCTGACAAGATTAAGTTTTCCAAAACAATGGACTTTTCCAAAACACTTTCCTTCCAAAACCAAGTCTCGAAAGCTGATGTAAGGCGAAAGCTGACCAAAACATGAAAGCTGACTGACTGAATTCCAAAACTTGCTTCCAAAACGTCACGTCGGTCTATTGAAAGCTGAAAAGAAAGCTGAAAAGCTGAGTTAGGCTTTCTCGAAAGCTGATCTCTTTCTCTTCTTTCTCTGAAAGCGAAAGCTGAGCTATAACAGAGGCCATCTAGAAGAAAGCTGATGTGTAAATTTCCTTTCTCTTCGTGGGAAAGCTGAAATCTTTCTCTTTCTTTAGCCGACGCACTTTCTCTTTCTAAACAGAAAGCTGATCTTTAGTAACTGAAAGCTGAGAAAGCTGATTTTTCTCTTGCTTTCTCTTCTTTCGAAAGCTGGAAAGCTGATCGAAAGCTGATTGCGAAGAAAGCTGACCTTTCTCTTTGAAAGCTGACAAGACTTTCTCTTACCTACTGATTCAAGCGAAAGCTGAAAGCTGAGCGAAAGCTGACTTCTTTCTCTTTCTGAAAGCTGAGATTTCTCTTCTTACTTTCTCTTAAGAAAGCTGAAGTAAGAAAGCTGATTGACTTTCTTTCTCTTTGGAACAATTCAGCTGCTACGAAAGCTGATGAGCTACGCCACTAGTGTTTACCAGTACCGTGAGTCGTTGGTGGCACGGTCTTGGAACCTCGTGTGAACGCCTTCCCTGTCTCCGGTAATACATCAACTTCTCACTGCGTCGATAAGATGCATAGCGCGTTCCGTTGCGCATTGGCTCAATGTGGCTATAAAGCCGCCCAAGGGCTCGTATGGCATCCTATTCACATGACCATCTTCGCGTATGCGACCGGCTAGAACGTTACGTGGAACCCACGCCTTACCACCCGTGCAAACAACAAGAGCCAACTGCCGGTCTCCAGGATTGACGCAGAGAACCATCTACTAAATCGAAAATAGGCAGCGTCCCAGATTCGGGACGGAGGGGCTGGTGGAGTAATTTCACTCATATGGTCGAACACGTCAATATCTCGAAAGCAACTTTCAAATCCCTTGACCAGTCTGTTGCGTGCCCTTGACCCCTTGACCCTTGACCGAACCCTTGACCCGTGCTTTATTACGTGTGCCCCCTTGACCAGCCCTTGACCCTGAACCCTTGACCGTAGCGACCTTAAGCAAACGGGAGTGATACCTTAGTCTGTCTCGCGCTGGATCCCCTTGACCCCCAAGAAAACCGATACGATCGTCCTCTTTGTGCCCTTGACCCCTTGACCCGACGATCGTCCCCCCTTGACCACCTTTGCCCTTGACCATGACCCCCTTGACCTCGGCCCGTAACGGTCCCTTGACCCCGCGGACACGTATCCGAACTAAGCCCGCCGCTGTGTTGAAATGGTGCCCTTGACCTGACCCGTTATTTCCCTTGACCCCCTTGACCTGGTAACACATCCCTTGACCAATTCCCTTGACCAGCCAGTAAATAAAATCTGAAGTTCCTCCCTTGACCCCCTTGACCCTCCCTTGACCACCGCGGACGTTGGGTAGCATATTCCCTTGACCTGTTCGTCCCTTGACCTTGGGTAGCTTGGGTAGCGAATGGCGAACGGCTAAGGTGGATTTGGGTAGCTTCCCCTCGGAACAATGTTTCCTGTTACACTCTTGGGTAGTTTACACTCTGCAGCGCTGGGTTACACTCTACTTATTACACTCTGCCCGCGCTGCTTACTTACACTCTGGTCAAAGCGCCGTAAGCGAGAGAGCATGACCCGGTGGGCGGCGAAATTGGGTAGCCAATTTACACTCTTTTTTGGGTAGCTACCAGGGTGTAACTTTTTACACTCTGGTAGCTGAGAATGAATTGTGCCTTACACTCTGTAGCTAACAATGCTGTGCGCTTACACTCTGCTTACACTCTATTACACTCTGGACAATTGATTACCATTACACTCTGCGTTACACTCTCAGTGCCCACTCTTACACTCTTTTTAATTACACTCTTAGTTGTTGTTACACTCTTGGGTATTTTACACTCTAAAAGGTTTTACACTTTACACTCTGGCCTGCCAGGCGATTACACTCTCCTCCTACAGACTTACACTCTGCCTACATGATATCCGCAACTCTATATTGGAGGGTTACACTCTTGTTGATAAGGGGTCATTACTTTACACTCTTGCAGTGAGTCTCAGATTACACTCTTATATTTTACACTCTCTCTAGACTAGCGCCATTTACACTCTGACCACTCCATAATTGACTGTTCCACTTCAATTATCTCGAGACTCAGAAGGCGAGACGACTTTTTCATTTAGCTCGCGGTATTTGGAACTAGACCGTGACATTTGGCCCTGTCAATCGCCACTAAGAACGAAGCTACACTCCTCAGGAGTCTGGTCCTCATTCTACAAGTATCGAAAGACCTGGTAGTCTAAAAAACTATTCTAACACACCTGTGCACACTTTGGCCGAGGTGGCTTGAACACTGCCTTGCCTTCCCTTCGTAATGCGAAGATAGACCAACGGCATTCCTGTAACCAGCAGTGACGACGCGCTAAGCGTGGTCGTGGCAGAGATGGTCGTTCTGTTGCGTGGCAGGAAGTGGGAGGTTCTCGCGCCTCTTAGCCTCATAGTCTACCGTTGAATAATCAGGAGTGGAGACGATTATTAAAAGCACCGACATTACCCCTTTCCAGCATGTGGTTCGTACGGGGTACTTATTGGGTCTCATACCGATGATGTAGCCTCTGGCCGCCGGTTGGTATGTCTGACGCCTAGTATGTTGCTTTACTGTAATTATCCGCGGAAAGTAACGGTCGGGTTGCTTTCTTCTGACGGCCAGCAATATTAAAACATCTTCTGGACCAGTTTCATGAAACCTTTTTCAGCCTAATCGGAGTAGGGCGAATTATGACAGACGTTTAGCTTCTAAGGCTCCTGGTCTCTCCTGATGTTTCGTTGACATCGGAAGCCCACTGCCAAACGATATTAATTCCGGACTATTACAAGCGTTGGAATTGGACACAGAAAGACGACTTTATAGTGGCCATGTCAAAGGTTCGAGATAAATCGCCGTCAATACCTGATCTTAGGCTGGGAGCCACGTCTCAGAGCATAATTGGACCATGCCTTAATATTTCCAATTCAAAGGTCCGCAGGACCCACGCATAGGAGTAGGTCCATGTGATAGTGAGTGGCGGGCGCGGGAATCGAGATTTCTAAAAGGGGCGGGTAATACTGCATACTTTGATCTCATGCTGGCTCCGAGCAATCCCTGGCATCTGGATCAACGCCTGTTTCGTACCATAGTCAGACCATCCCAAGGTCTGGCCTACTAGATTACACCCCCCGCACGAGTGTGATACCACGCGTCGGGCTGAATTGCTCTCAGATAGTTGAGATTACCGCATCACATATGACGGTTGCCGACACCATCGACGGACCTCAGTAAAGATAACACTGAAACGTCGTCGTTATTGTTCTTGTATACGGTGTCTCCGGTCTGGGGGGCCTCTTAAGCCGCGTTCCGCGGTACATCCGCCAGTAACCAGGGACTGTCTCCGGGCTATGGACTCACTACGCTGCTTGCTTACCGTTGACCATCAAAATTGAGTAAAGCGAGGCACTCCGGCAATACGCCAGTCCACGTCCCTCATTATTAGAATCGAACCCTGACCGCTTTAATTTATGGGCGGACCATGCACGGTAGTCGAGCGGAGCATCTAGTCCCAGGGGTGACTGAGACCCGTCCTGTACTGCAATGAGCTTCCACCTAACTGCGGCCGTTGTCTTCCGAATGGTCTAGGCGGTTAGGAGTAAGCTATTGGGGTGCTGGGCAGCGCAGTCATACACTTTGCACGCGAGGTACCTTTCCTTAATCGTGTCGCTGGCCCGTGCAAGTCGTTATGCATTCCCCATTCTCCAGTTTTCGATACTAGGTTACCCGGTTGTTCCAATCTTGCGGAGGGGGGGACTAAAATGAGGGGCTAGGGCAAGTCCTTACCCCTTATTATAGCGCTTCGTGCTCCGATGGTGACTGTAATCTAGGGGAAACCGTAGACGTGTCCTTTTCGACAAGTGGCCCGGGTCAGGGGAGTATAGGTACATCTAGGGCGTGTCGGTTGTTTGACCCTAGCCAATAGTTTTTCATGACGCTGCACGAAAAATAGAGCGTGAAGACCTCCCCAGTCGCTCCAGGTAGGGTGCGTTAAGTCCGAACGGTGTGGCCCCTGTAGTTACGGTCACCATAACTAAGTTAATGGATACACTCATAACACTTCAATTACAATTTATGACACTGGGGTGGTTTTGAGGTGTATTTGGTGCGCTTAGGTCCGAGGTCTAAAAGTGCGAGCATCCACTTCAGGATATGTCCCAATTTACAGGTAGTTTTTAGAGTGCCCGAGCCCAACATTCAACCTGACTTAAGTCCGACTCTCCCGAGGGTTACATACATCAGATGCGAGAACAGTCTGGATTTGCATCACGACATTAAGTTACCGACCTGTGTGGCGCGCTACGGAGGGCACTGATACTACGATACCCTACGAAGATTTAGGCGACTCGGAGCGACTTACTGAAAAGAATAGTTAGCAAGCAGGGGCCTGTGGGAACGACCTAAGACGCGACGAAGTCTACACTGCGAGCCACCGGATGGCCCCTCAAATAAGTAAACAGCCGGTCCTCCACGTAGATGATTGATGCTCAGACACTTCGCCTTTGATCTGTGTTTGCCACTGGTCATATCATGACGTACATTAAAATCCCAACGACCTATGAATCTAGACTCGGGAGAACTCTGTCACAAATTTGAGTTTGACATCCGCATAGCGGTCGATGGGTGAGTCAAACAAATCTCGCGACTTCTCCCCCCTCTATCCACACATCCTACTCAAGTCTATGCAATCTCGCGGCGTACTATCGTTCCGCACCCCATATACTAAATCTCGCGTAATCTCGCGGTAAGCAATCTCGCGCAGCAGGGCCTCGGCATGCATCCGATGGTGTGCGTGGACCAGGTGGGCACGAATCTCGCGACTCGTAATTTATGAGGTGTCGCTTCAATCTCGCGCGCGTCATCTCATACACCGCATGTGGTAATCTCGCGCTTTTGTGAAATCTCGCGCATAAAATCTCGCGGCAGTAATCTCGCGTCGCGAGCACAAATCTCGCGGCCGGACTACATGCTAGAGGTGCAGAAAAATCTCGCGGTCGTGGCTCATCGGATGCCCGGTAGGGGTCCTGACAAGAAGATATGACCGCAATCTCGCGATGTATGCAATCTCGCGACTTTGCGAATCTCGCGGAGTCAAAGGCCAATCTCGCGGGCTCAATACGCCAATCTCGAATCTCGCGGCGCTCGACCCCGACAGCGCCGAGGATATCTAACTCGAAATCTCGCGAATCTCGCGAAATCTCGCGGATATTAAACGAATCTCGCGATCTCGCGGAAAAACTAATTAGGAGGCTAAGACACTAGTTACGGCATTCCCCATTGGAACTCTGGACGGGACCGTTGACCAAGTGAGTGCATGAAAGTTGTGGGCACCCGGTTACGGATTCACGCAGGCGACGACCAGGCGGACAAGATTTAGATTTAGATTGTCCCACATACCGGATTTAGATTTTCAGTAGTAGATTTAGATATTTAGATTTTTAGATTTAGATTTGCGCGCCGGTTAAGACTTAAGGCGGGTAGCAGACTGGGGACGTTCAGCCAAAGATATTATTTAGATTCCTTCTCCGGTGGCCATAAAATTTAGATTTTCCTACCGGGCCCCACAATCGTCCGCTCCCTCTACTAATTTAGATTCTTGTGAATTTAGATTAATGTCACAATTCGCCCTTCCATTTAGATTCGTCATTACAGGACCATTTTCTTTCTCACCATTTTCTGATTCTATTTAGATTGCCATTTCCATTTTCTCTCCCATTTTCTCCATACGATCCTCGGTCCGATAGAATGACCCATTTTCTCTACCATTTTCCCATTTTCTTCCCTGCATAGTGAAAACCAAGACCATTTTCTACCATTTTCTGTATTTAGAACCATTTTCTATATTTAGATTCCATTTTCTTTTAAAACCAAGTAAAAAAAACCAAGCAAAACAAAACCAAGCCACCATTTTCTTAGATTCCATTTTCTTGATTTCCATTTTCTTTTTCTAAGGCATCACGAAAAACCAACCATTTTCTCGCCGGTCAACCTGGGAGGGTCCGCCATTTTCTAAACCAAGACCATTTTCTCCAAGTTACTAGTGCCACCTCACAGTCCACCATTTTCTCCATTTTCTCGCCCACGCCCATTTTCCATTTTCTGTGTGCACTATTAGCAAAACCAAGGAGAAAACCCATTTTCTACTGAGTGTTGGTAAGGTTACGTGGTGGCCTGACGGCCATTTTCTTCCAAAACCAAGTCCCATTTTCTCTGCTGCTTAATGGAAATAATGGCCATTTTCTAAATAATGAAAACCAAGGAAATAATGAAAACCAAGGAAAAAAAAAACCAAGAGGAAATAATGGAAATAATGGAAATAATGGAAAAATGGAAATTAATGGAAATAATGGAAATAATGGAAATAATGGAAATAATGGAATGGAAATAAATAATGGAAATAATGGAAATAATGGAAATAATGGAAATAATGGAAATAATGGAAATAATGGAAATAATGGAAATAATGGAAATAATGGAAATAATGGAAATAATGGAAATAATGGAAATGTCGGCATCGTCGGCATCGTCGGCATCGTCGGCATCGTCGGCATCGTCGGCATCGTCGGCATCGTCGGCATCGTCGGCATCGTCGGCATCGTCGGCATCGTCGGCATCGTCGGCATCGTCGGCATCGTCGGCATCGTCGGCATCGTCGGCATCGTCGGCATCGTCGGCATCGTCGGCATCGTCGGCATCGTCGGCATCGTCGGCATCGTCGGCATCGTCGGCATCGTCGGCATCGTCGGCATCGTCGGCATCGTCGGCATCGTCGGCATCGTCGGCATCGTCGGCATCGTCGGCATCGTCGGCATCAATTGGCGCAATTGGCGCAATTGGCGCAATTGGCGCAATTGGCGCAATTGGCGCAATTGGCGCAATTGGCGCAATTGGCGCAATTGGCGCAATTGGCGCAATTGGCGCAATTGGCGCAATTGGCGCAATTGGCGCAATTGGCGCAATTGGCGCAATTGGCAAAAGAACCGCAATTGGCGCAATTGGCGCAATTGGCGCAATTGGCGCAATTGGCGCAATTGGCGCAATTCAAAAGAACGGCGCAATTGGCGCAATTGGCCAAAAGAACGCAATTGGCCAAAAGAACGCAATTGGCGCAATTGGCGCAAAAGAACCAAAAGAACCAAAAGAACCCAAAAGAACAAAAGAACCAAAACAAACAAAAGAACCAAAAGAACCAAAAGAACCAAAACAAAAGAACGAACCAAAAGAACCAAAAGAACCAAAAGAACCAAAACAAAAGAACGAACCAAAAGAACCAAAAGAACCAAAAGAACCAAAAGAACCAAAAGAACCAAAAGAACCAAAAGAACCAAAAGAAC"
print clumpfinderb(gen, 9, 494, 17)
